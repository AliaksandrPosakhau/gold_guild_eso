pipeline{

    agent any
    
    options{
        disableConcurrentBuilds()
    }

    stages{
        stage("INSTALL NPM AND DEPLOY ENVIRONMENT"){
            steps{
                echo "========executing NPM INSTALL COMMAND========"
                bat "npm install"
                echo "========executing WEBDRIVER MANAGER UPDATE COMMAND========"
                bat "npx webdriver-manager update --versions.chrome 76.0.3809.68"
                
            }            
        }

        stage("EXECUTING APPLICATION"){
            steps{
                   script{
                echo "======== LAUNCHING TEST ========"
                bat "SERVER_NAME=${params.JENKINS_SERVNAME} npx protractor config/conf.js"  
                // "NODE_ENV=${params.NODE_ENV} npx protractor ./conf.js --specs=${params.PATH_TO_FEATURE_FILE}" 
                }
            }            
        }
    }    
}
